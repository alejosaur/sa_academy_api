"main";let ApolloServer,gql;_db1‍.w("apollo-server",[["ApolloServer",["ApolloServer"],function(v){ApolloServer=v}],["gql",["gql"],function(v){gql=v}]]);let ResidentAPI;_db1‍.w("./datasource",[["ResidentAPI",["ResidentAPI"],function(v){ResidentAPI=v}]]);yield;


const typeDefs = gql`
    type Resident {
        _id: String!
        identity_document: Int
        name: String!
        birth_date: String
        admission_date: String!
        gender: String!
        state: String
        contact_name: String
        contact_phone: Int
        diseases: String
    }

    type report_types {
        id: Int!
        Type: String!
    }

    type reports {
        id: Int!
        created_at: String
        IP: String
    }

    type Query {
        resident(idNumber: String!): Resident
        residents: [Resident]
        reports: [Report]
    }
`;

const resolvers = {
    Query: {
        resident: (root, { idNumber }, { dataSources }) =>
        dataSources.ResidentAPI.getAResident(idNumber),
        residents: (root, args, { dataSources }) => dataSources.ResidentAPI.getAllResidents(),
        resident: (root, { idNumber }, { dataSources }) =>
        dataSources.ResidentAPI.getAResident(idNumber),
        residents: (root, args, { dataSources }) => dataSources.ResidentAPI.getAllResidents(),
    },
    Resident: {
        identity_document: ({ idDoc }) => idDoc,
        diseases: ({ reportedDiseases }) => reportedDiseases,
    },
};

const server = new ApolloServer({
    typeDefs,
    resolvers,
    dataSources: () => ({
        ResidentAPI: new ResidentAPI(),
    }),
});

server.listen().then(({ url }) => {
    _db1‍.g.console.log(`🚀 Server ready at ${url}`);
});

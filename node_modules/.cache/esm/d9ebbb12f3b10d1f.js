"main";let ApolloServer,gql;_f3b‍.w("apollo-server",[["ApolloServer",["ApolloServer"],function(v){ApolloServer=v}],["gql",["gql"],function(v){gql=v}]]);let CoursesAPI;_f3b‍.w("./datasource",[["CoursesAPI",["CoursesAPI"],function(v){CoursesAPI=v}]]);


const { find, filter } = require('lodash');

const typeDefs = gql`
    type Course {
        code: ID!
        credits: int
        name: String
        professor: String
    }

    type Query {
        course(idNumber: String!): Course
        courses: [Course]
    }

    type Mutation {
        createCourse(    credits: int
                        name: String
                        professor: String): Course

        updateCourse(   code: ID!
                        credits: int
                        name: String
                        professor: String): Course

        deleteCourse(idNumber: String):String
    }
`;

const resolvers = {
    Query: {
        resident: (root, { idNumber }, { dataSources }) => dataSources.ResidentAPI.getAResident(idNumber),
        residents: (root, args, { dataSources }) => dataSources.ResidentAPI.getAllResidents(),
        report: (root, { idNumber }, { dataSources }) => dataSources.ReportsAPI.getAReport(idNumber),
        reports: (root, args, { dataSources }) => dataSources.ReportsAPI.getAllReports(),
        report_type: (root, { idNumber }, { dataSources }) => dataSources.ReportsAPI.getAType(idNumber),
        report_types: (root, args, { dataSources }) => dataSources.ReportsAPI.getAllTypes(),
        transaction: (root, { idNumber }, { dataSources }) => dataSources.TransactionAPI.getATransaction(idNumber),
        transactions: (root, args, { dataSources }) => dataSources.TransactionAPI.getAllTransactions(),
        employee: (root, { idNumber }, { dataSources }) => dataSources.EmployeeAPI.getAnEmployee(idNumber),
        employees: (root, args, { dataSources }) => dataSources.EmployeeAPI.getAllEmployees(),
        user: (root, { idNumber }, { dataSources }) => dataSources.EmployeeAPI.getAnUser(idNumber),
        users: (root, args, { dataSources }) => dataSources.EmployeeAPI.getAllUsers(),
        nursinghome: (root, { idNumber }, { dataSources }) => dataSources.NursingHomesAPI.getANursingHome(idNumber),
        nursinghomes: (root, args, { dataSources }) => dataSources.NursingHomesAPI.getAllNursingHomes(),
        branch: (root, { idNumber }, { dataSources }) => dataSources.NursingHomesAPI.getABranch(idNumber),
        branches: (root, args, { dataSources }) => dataSources.NursingHomesAPI.getAllBranches(),
    },
    Mutation: {
        newResident: (root, args, { dataSources }) =>  dataSources.ResidentAPI.createAResident(args),
        newReport: (root, args, { dataSources }) =>  dataSources.ReportsAPI.createAReport(args),
        newReportType: (root, args, { dataSources }) =>  dataSources.ReportsAPI.createAReportType(args),
        newTransaction: (root, args, { dataSources }) =>  dataSources.TransactionAPI.createATransaction(args),
        newEmployee: (root, args, { dataSources }) =>  dataSources.EmployeeAPI.createAnEmployee(args),
        newUser: (root, args, { dataSources }) =>  dataSources.EmployeeAPI.createAnUser(args),
        newNursinghome: (root, args, { dataSources }) =>  dataSources.NursingHomesAPI.createANursingHome(args),
        newBranch: (root, args, { dataSources }) =>  dataSources.NursingHomesAPI.createABranch(args),

        editResident: (root, args, { dataSources }) =>  dataSources.ResidentAPI.editAResident(args),
        editReport: (root, args, { dataSources }) =>  dataSources.ReportsAPI.editAReport(args),
        editReportType: (root, args, { dataSources }) =>  dataSources.ReportsAPI.editAReportType(args),
        editTransaction: (root, args, { dataSources }) =>  dataSources.TransactionAPI.editATransaction(args),
        editEmployee: (root, args, { dataSources }) =>  dataSources.EmployeeAPI.editAnEmployee(args),
        editUser: (root, args, { dataSources }) =>  dataSources.EmployeeAPI.editAnUser(args),
        editNursinghome: (root, args, { dataSources }) =>  dataSources.NursingHomesAPI.editANursinghome(args),
        editBranch: (root, args, { dataSources }) =>  dataSources.NursingHomesAPI.editABranch(args),

        deleteResident: (root, { idNumber }, { dataSources }) =>  dataSources.ResidentAPI.deleteAResident(idNumber),
        deleteReport: (root, { idNumber }, { dataSources }) =>  dataSources.ReportsAPI.deleteAReport(idNumber),
        deleteReportType: (root, { idNumber }, { dataSources }) =>  dataSources.ReportsAPI.deleteAReportType(idNumber),
        deleteTransaction: (root, { idNumber }, { dataSources }) =>  dataSources.TransactionAPI.deleteATransaction(idNumber),
        deleteEmployee: (root, { idNumber }, { dataSources }) =>  dataSources.EmployeeAPI.deleteAnEmployee(idNumber),
        deleteUser: (root, { idNumber }, { dataSources }) =>  dataSources.EmployeeAPI.deleteAnUser(idNumber),
        deleteNursinghome: (root, { idNumber }, { dataSources }) =>  dataSources.NursingHomesAPI.deleteANursinghome(idNumber),
        deleteBranch: (root, { idNumber }, { dataSources }) =>  dataSources.NursingHomesAPI.deleteABranch(idNumber),
    },
    Report: {
        report_type: (root, { report_type_id }, { dataSources }) =>  dataSources.ReportsAPI.getAType(root.report_type_id),
    },
    Nursinghome: {
        branches: (root, { idnursinghome }, { dataSources }) =>  dataSources.NursingHomesAPI.getNursinghomesBranches(root.idnursinghome),
    },
};

const server = new ApolloServer({
    typeDefs,
    resolvers,
    dataSources: () => ({
        ResidentAPI: new ResidentAPI(),
        ReportsAPI: new ReportsAPI(),
        TransactionAPI: new TransactionAPI(),
        EmployeeAPI: new EmployeeAPI(),
        NursingHomesAPI: new NursingHomesAPI(),
    }),
});

server.listen().then(({ url }) => {
    _f3b‍.g.console.log(`🚀 Server ready at ${url}`);
});
